{
  "id": "5b4c14140584295cc4c1185c",
  "database": "todo",
  "collection": "users",
  "roles": [
    {
      "name": "read",
      "apply_when": {
        "_id": "%%user.id"
      },
      "read": true,
      "write": true,
      "insert": true,
      "delete": true,
      "additional_fields": {
        "write": true,
        "read": true
      }
    },
    {
      "name": "write",
      "apply_when": {
        "%or": [
          {
            "%%prevRoot._id": "%%user.id"
          },
          {
            "%%prevRoot": {
              "%exists": false
            }
          }
        ]
      },
      "write": true,
      "insert": true,
      "delete": true,
      "additional_fields": {
        "write": true
      }
    }
  ],
  "schema": {
    "properties": {
      "_id": {
        "bsonType": "string"
      },
      "phone_number": {
        "bsonType": "string"
      },
      "number_status": {
        "bsonType": "string"
      },
      "verify_code": {
        "bsonType": "string"
      }
    }
  }
}